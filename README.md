# è‚¡ç¥¨æ•°æ®å¯è§†åŒ–é¡¹ç›®

åŸºäº Next.js 14ï¼ˆApp Routerï¼‰å‰ç«¯å’Œ NestJS åç«¯çš„è‚¡ç¥¨æ•°æ®å¯è§†åŒ–å·¥å…·ï¼Œä½¿ç”¨ SQLite3 ä½œä¸ºæ•°æ®æºï¼Œé€šè¿‡ Lightweight Charts å®ç°ä¸“ä¸šçº§ K çº¿å›¾å±•ç¤ºã€‚

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

### æ•°æ®å±•ç¤ºåŠŸèƒ½
- ä¸“ä¸š K çº¿å›¾ï¼ˆèœ¡çƒ›å›¾ï¼‰å±•ç¤º
- å†å² PE/PB æ›²çº¿å›¾
- è‚¡ç¥¨åŸºæœ¬ä¿¡æ¯å±•ç¤º

### äº¤äº’åŠŸèƒ½
- å›¾è¡¨ç¼©æ”¾ï¼ˆé¼ æ ‡æ»šè½®ï¼‰
- æ—¶é—´èŒƒå›´æ‹–æ‹½
- åå­—å…‰æ ‡æŸ¥çœ‹è¯¦ç»†æ•°æ®
- å›¾è¡¨ç±»å‹åˆ‡æ¢
- æŠ€æœ¯æŒ‡æ ‡å¼€å…³
- æˆäº¤é‡å›¾æ˜¾ç¤º
- å®æ—¶æ•°æ®æç¤ºï¼ˆé¼ æ ‡æ‚¬åœæ˜¾ç¤ºå½“æ—¥å¼€ç›˜ã€æ”¶ç›˜ã€æœ€é«˜ã€æœ€ä½ã€æˆäº¤é‡ç­‰æ•°æ®ï¼‰
- æ—¶é—´èŒƒå›´å¿«é€Ÿé€‰æ‹©ï¼ˆ1ä¸ªæœˆã€3ä¸ªæœˆã€6ä¸ªæœˆã€1å¹´ã€å…¨éƒ¨ï¼‰

### æ•°æ®ç®¡ç†
- è‚¡ç¥¨ä»£ç æœç´¢
- è‡ªé€‰è‚¡ç®¡ç†
- å†å²æ•°æ®æŸ¥è¯¢
- æ•°æ®å¯¼å‡ºåŠŸèƒ½

### ç”¨æˆ·ç•Œé¢
- å“åº”å¼è®¾è®¡ï¼ˆæ”¯æŒæ¡Œé¢å’Œç§»åŠ¨ç«¯ï¼‰
- ç°ä»£åŒ– UI è®¾è®¡
- å®æ—¶æ•°æ®æ›´æ–°

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ•´ä½“æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ç”¨æˆ·æµè§ˆå™¨                   â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚    Next.js 14 å‰ç«¯ (App Router)    â”‚   â”‚
â”‚    â”‚    â€¢ Lightweight Charts å›¾è¡¨       â”‚   â”‚
â”‚    â”‚    â€¢ Tailwind CSS æ ·å¼             â”‚   â”‚
â”‚    â”‚    â€¢ å®¢æˆ·ç«¯çŠ¶æ€ç®¡ç†                â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ HTTP/HTTPS (RESTful API)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              NestJS åç«¯æœåŠ¡                 â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚    REST API æ§åˆ¶å™¨                 â”‚   â”‚
â”‚    â”‚    â€¢ æ•°æ®æœåŠ¡å±‚                    â”‚   â”‚
â”‚    â”‚    â€¢ ä¸šåŠ¡é€»è¾‘å±‚                    â”‚   â”‚
â”‚    â”‚    â€¢ TypeORM æ•°æ®è®¿é—®å±‚            â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               SQLite3 æ•°æ®åº“                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚    stocks.db æ•°æ®æ–‡ä»¶              â”‚   â”‚
â”‚    â”‚    â€¢ TypeORM è¿æ¥                  â”‚   â”‚
â”‚    â”‚    â€¢ æ•°æ®è®¿é—®å±‚                    â”‚   â”‚
â”‚    â”‚    â€¢ æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–                  â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯ (Next.js 14)
- **æ¡†æ¶**: Next.js 14 (App Router)
- **UI åº“**: React 18, React Hooks
- **å›¾è¡¨**: Lightweight Charts (TradingView)
- **æ ·å¼**: Tailwind CSS
- **HTTP å®¢æˆ·ç«¯**: Axios
- **æ„å»ºå·¥å…·**: Vite (å¯é€‰)

### åç«¯ (NestJS)
- **æ¡†æ¶**: NestJS 10+
- **ORM**: TypeORM
- **æ•°æ®åº“é©±åŠ¨**: sqlite3
- **API æ–‡æ¡£**: Swagger/OpenAPI
- **éªŒè¯**: class-validator, class-transformer
- **é…ç½®**: @nestjs/config

### æ•°æ®åº“
- **æ•°æ®åº“**: SQLite3
- **æ–‡ä»¶**: stocks.db (ä½äº data/ ç›®å½•)
- **å·¥å…·**: TypeORM è¿ç§»å’Œç§å­

## ğŸ“ é¡¹ç›®ç»“æ„

```
stock-visual/
â”œâ”€â”€ frontend/                 # Next.js å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ app/                 # App Router é¡µé¢
â”‚   â”œâ”€â”€ components/          # React ç»„ä»¶
â”‚   â”œâ”€â”€ public/              # é™æ€èµ„æº
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ backend/                 # NestJS åç«¯åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ entities/        # TypeORM å®ä½“
â”‚   â”‚   â”œâ”€â”€ controllers/     # API æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ services/        # ä¸šåŠ¡é€»è¾‘æœåŠ¡
â”‚   â”‚   â””â”€â”€ dto/             # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ data/                    # æ•°æ®åº“æ–‡ä»¶
â”‚   â””â”€â”€ stocks.db            # SQLite æ•°æ®åº“
â”œâ”€â”€ shared/                  # å…±äº«ä»£ç 
â”œâ”€â”€ package.json             # æ ¹é¡¹ç›®é…ç½®
â””â”€â”€ README.md
```

## ğŸš¦ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚
- Node.js 18+ å’Œ npm 9+
- Git

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone <repository-url>
   cd stock-visual
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   npm run install:all
   ```

3. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**
   ```bash
   npm run dev
   ```

4. **è®¿é—®åº”ç”¨**
   - å‰ç«¯: http://localhost:3000
   - åç«¯ API: http://localhost:3001

### å¼€å‘è„šæœ¬

| å‘½ä»¤ | æè¿° |
|------|------|
| `npm run dev` | åŒæ—¶å¯åŠ¨å‰ç«¯å’Œåç«¯å¼€å‘æœåŠ¡å™¨ |
| `npm run dev:frontend` | ä»…å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨ |
| `npm run dev:backend` | ä»…å¯åŠ¨åç«¯å¼€å‘æœåŠ¡å™¨ |
| `npm run build` | æ„å»ºå‰ç«¯å’Œåç«¯ç”Ÿäº§ç‰ˆæœ¬ |
| `npm run start` | å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨ |
| `npm run test` | è¿è¡Œæµ‹è¯• |

## ğŸ“Š æ•°æ®åº“è¯´æ˜

æ•°æ®åº“åŒ…å«ä»¥ä¸‹ä¸»è¦è¡¨ï¼š

1. **stock_day_pepb_data** - è‚¡ç¥¨æ—¥çº§PE/PBæ•°æ®
2. **ROE_DATA** - ROEæœé‚¦åˆ†ææ•°æ®
3. **stock_a_all_pb** - å…¨Aè‚¡å¸‚å‡€ç‡æ•°æ®
4. **index_valuation_data** - æŒ‡æ•°ä¼°å€¼æ•°æ®
5. **stock_industry_data** - è‚¡ç¥¨è¡Œä¸šåˆ†ç±»æ•°æ®
6. **stock_bonus_data** - è‚¡ç¥¨åˆ†çº¢æ•°æ®
7. **hushen300** - æ²ªæ·±300æŒ‡æ•°æ•°æ®
8. **zz500** - ä¸­è¯500æŒ‡æ•°æ•°æ®

è¯¦ç»†æ•°æ®åº“ç»“æ„è¯·å‚è€ƒ [db.md](./db.md)ã€‚

## ğŸ”§ é…ç½®è¯´æ˜

### åç«¯é…ç½®
åç«¯é…ç½®æ–‡ä»¶ä½äº `backend/.env`ï¼ˆéœ€è¦åˆ›å»ºï¼‰ï¼š
```env
DB_TYPE=sqlite
DB_DATABASE=../data/stocks.db
PORT=3001
CORS_ORIGIN=http://localhost:3000
```

### å‰ç«¯é…ç½®
å‰ç«¯é…ç½®æ–‡ä»¶ä½äº `frontend/.env.local`ï¼ˆéœ€è¦åˆ›å»ºï¼‰ï¼š
```env
NEXT_PUBLIC_API_URL=http://localhost:3001
```

## ğŸ“ˆ API æ¥å£

### è‚¡ç¥¨æ•°æ®æ¥å£
- `GET /api/stocks` - è·å–è‚¡ç¥¨åˆ—è¡¨
- `GET /api/stocks/codes` - è·å–è‚¡ç¥¨ä»£ç åˆ—è¡¨
- `GET /api/stocks/:code` - è·å–æŒ‡å®šè‚¡ç¥¨æ•°æ®
- `GET /api/stocks/:code/latest` - è·å–æœ€æ–°è‚¡ç¥¨æ•°æ®
- `GET /api/stocks/:code/range` - è·å–æŒ‡å®šæ—¶é—´èŒƒå›´æ•°æ®

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œåç«¯æµ‹è¯•
npm run test:backend

# è¿è¡Œå‰ç«¯æµ‹è¯•
cd frontend && npm run test
```

## ğŸ“ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°å®ä½“
1. åœ¨ `backend/src/entities/` åˆ›å»ºå®ä½“ç±»
2. åœ¨ `backend/src/app.module.ts` ä¸­æ³¨å†Œå®ä½“
3. åˆ›å»ºå¯¹åº”çš„ Service å’Œ Controller

### æ·»åŠ æ–°é¡µé¢
1. åœ¨ `frontend/app/` åˆ›å»ºé¡µé¢æ–‡ä»¶
2. åœ¨ `frontend/components/` åˆ›å»ºç›¸å…³ç»„ä»¶
3. æ›´æ–°å¯¼èˆªèœå•ï¼ˆå¦‚æœéœ€è¦ï¼‰

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- [Next.js](https://nextjs.org/) - React æ¡†æ¶
- [NestJS](https://nestjs.com/) - Node.js æ¡†æ¶
- [TypeORM](https://typeorm.io/) - ORM å·¥å…·
- [Lightweight Charts](https://www.tradingview.com/lightweight-charts/) - å›¾è¡¨åº“
- [Tailwind CSS](https://tailwindcss.com/) - CSS æ¡†æ¶